---
title: Google Cloudì— í”„ë¡œì íŠ¸ ë°°í¬í•˜ê¸°
updated: 2024-02-07 12:00
---

> 'ê°€ê³„ë¶€ë¥¼ ë¶€íƒí•´' í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° ìž‘ì„±í•œ ë‚´ìš©ìž…ë‹ˆë‹¤.

[![project-logo](https://github.com/Ji-hoon/Home-accountant/raw/master/client/public/img-logo.png)](https://github.com/Ji-hoon/Home-accountant){:target="_blank"}

&nbsp;

ìƒˆë¡­ê²Œ ê°œì¸ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ ë‹¤ë¤˜ë˜ ê¸°ìˆ ë“¤ì— ëŒ€í•´ì„œ ê¸°ë¡ì„ ë‚¨ê²¨ë³´ë ¤ í•©ë‹ˆë‹¤. ì˜¤ëŠ˜ì€ ë„¤ ë²ˆì§¸ ì£¼ì œë¡œ, **êµ¬ê¸€ í´ë¼ìš°ë“œ Google Cloud**ì— í”„ë¡œì íŠ¸ë¥¼ ë°°í¬í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ë‹¤ë¤„ë³´ë ¤ í•©ë‹ˆë‹¤.

> í”„ë¡œì íŠ¸ ë³´ëŸ¬ê°€ê¸° ðŸ‘‰ : [ë§í¬](http://35.231.16.39/)

&nbsp;

## ëª©ì°¨

[1. êµ¬ê¸€ í´ë¼ìš°ë“œ ê°€ìž…í•˜ê³  ê°€ìƒ ë¨¸ì‹  ìƒì„±í•˜ê¸°](#1-êµ¬ê¸€-í´ë¼ìš°ë“œ-ê°€ìž…í•˜ê³ -ê°€ìƒ-ë¨¸ì‹ -ìƒì„±í•˜ê¸°)

[2. ê³ ì • IP ì„¤ì •í•˜ê³  í„°ë¯¸ë„ì—ì„œ VM ì ‘ê·¼í•˜ê¸°](#2-ê³ ì •-ip-ì„¤ì •í•˜ê³ -í„°ë¯¸ë„ì—ì„œ-vm-ì ‘ê·¼í•˜ê¸°)

[3. NginXì™€ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •í•˜ê¸°](#3-nginxì™€-í™˜ê²½-ë³€ìˆ˜-ì„¤ì •í•˜ê¸°)

[4. ë°©í™”ë²½ ì„¤ì •í•˜ê¸°](#4-ë°©í™”ë²½-ì„¤ì •í•˜ê¸°)

&nbsp;

---

&nbsp;

## 1. êµ¬ê¸€ í´ë¼ìš°ë“œ ê°€ìž…í•˜ê³  ê°€ìƒ ë¨¸ì‹  ìƒì„±í•˜ê¸°

ë¨¼ì € êµ¬ê¸€ ê³„ì •ìœ¼ë¡œ [êµ¬ê¸€ í´ë¼ìš°ë“œ](https://cloud.google.com/?hl=ko){:target="_blank"}ì— ê°€ìž… í•©ë‹ˆë‹¤. ê°€ìž… í›„ **ì½˜ì†”** í™”ë©´ìœ¼ë¡œ ì´ë™í•˜ë©´, (ì‹ ê·œ ê°€ìž…ì˜ ê²½ìš° **90ì¼ë™ì•ˆ 300ë‹¬ëŸ¬ì˜ ë¬´ë£Œ í¬ë ˆë”§**ì„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤)

ê°€ìž…ì„ ì™„ë£Œí•˜ë©´ ë””í´íŠ¸ í”„ë¡œì íŠ¸ê°€ ìžë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤. ìš°ì¸¡ ìƒë‹¨ì˜ ë©”ë‰´ ë²„íŠ¼ì„ ëˆŒëŸ¬ **Compute engine > ê°€ìƒ ë¨¸ì‹  > VM ì¸ìŠ¤í„´ìŠ¤** ë©”ë‰´ë¥¼ í´ë¦­í•˜ê³ , **ì¸ìŠ¤í„´ìŠ¤ ë§Œë“¤ê¸° ë²„íŠ¼**ì„ í´ë¦­í•©ë‹ˆë‹¤.

&nbsp;

![create vm](/blog/assets/posts/asset-deploy-on-gcp-screenshot00.png)

&nbsp;

ì´ ë•Œ ê²°ì œ ê³„ì •ì„ ë“±ë¡í•˜ë¼ê³  í•˜ëŠ”ë°, ë¹„ìš©ì´ ê²°ì œë  ì‹ ìš© ì¹´ë“œ ì •ë³´ë¥¼ ë“±ë¡í•˜ê³  ì´í›„ ì ˆì°¨ë¥¼ ì§„í–‰í•˜ë©´ ë©ë‹ˆë‹¤. VM ì¸ìŠ¤í„´ìŠ¤ ì„¤ì • ì˜µì…˜ì— ë”°ë¼ ê³¼ê¸ˆ ë‚´ìš©ì´ ë‹¬ë¼ì§€ê²Œ ë˜ë¯€ë¡œ, ì—¬ê¸°ì„œëŠ” ë¬´ë£Œì˜ ê°€ê¹Œìš´ ë¹„ìš©ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìžˆëŠ” ì˜µì…˜ì„ ì„ íƒí•©ë‹ˆë‹¤. 

1. **ë¦¬ì „**ê³¼ **ì˜ì—­**ì€ ë‹¤ìŒ [ë§í¬](https://cloud.google.com/free/docs/free-cloud-features?hl=ko#compute){:target="_blank"}ë¥¼ ì°¸ì¡°í•˜ì—¬ ì„ íƒ í•©ë‹ˆë‹¤. (ì €ëŠ” `us-central1(ì•„ì´ì˜¤ì™€)` - `us-central1-a`ë¥¼ ì„ íƒ)
2. **ë¨¸ì‹  êµ¬ì„±**ì€ `E2`ë¥¼ ì„ íƒí•˜ê³ , **ë¨¸ì‹  ìœ í˜•**ì€ `e2-micro` ì˜µì…˜ì„ ì„ íƒí•´ì¤ë‹ˆë‹¤.


&nbsp;

![instance option](/blog/assets/posts/asset-deploy-on-gcp-screenshot01.png)

&nbsp;

ë¶€íŒ… ë””ìŠ¤í¬ì˜ ê²½ìš° ìµìˆ™í•œ OSë¡œ ì„ íƒì„ í•˜ì‹œë©´ ë˜ëŠ”ë°, ì €ëŠ” `Ubuntu`ì™€ `20.04 LTS`ë²„ì „ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤. ë””ìŠ¤í¬ íƒ€ìž…ì€ `í‘œì¤€ ì˜êµ¬ ë””ìŠ¤í¬`ë¡œ, ìš©ëŸ‰ì€ `30GB`ë¡œ ìž¡ì•„ì£¼ê³  **ë³€ê²½**ì„ í´ë¦­í•©ë‹ˆë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ ë°©í™”ë²½ ì„¤ì •ì€ `http` ì™€ `https` ì˜µì…˜ì´ ìžˆëŠ”ë°, ì €ëŠ” `http`ë§Œ ì‚¬ìš©í•  ì˜ˆì •ì´ê¸° ë•Œë¬¸ì— `http íŠ¸ëž˜í”½ í—ˆìš©` ì˜µì…˜ ë§Œ ì„ íƒí–ˆìŠµë‹ˆë‹¤. ì„¤ì •ì„ ì™„ë£Œí–ˆë‹¤ë©´ í™”ë©´ í•˜ë‹¨ì˜ **ë§Œë“¤ê¸°** ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ê°€ìƒ ë¨¸ì‹  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. (ì™„ë£Œë˜ê¸° ê¹Œì§€ ì‹œê°„ì´ ì¡°ê¸ˆ ê±¸ë¦½ë‹ˆë‹¤)


&nbsp;

## 2. ê³ ì • IP ì„¤ì •í•˜ê³  í„°ë¯¸ë„ì—ì„œ VM ì ‘ê·¼í•˜ê¸°

VM ìƒì„±ì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´, **Compute engine > ê°€ìƒ ë¨¸ì‹ ** í™”ë©´ ì§„ìž… ì‹œ ìƒì„±í•œ VM ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤. ë‹¤ìŒì€ VMì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ ì™¸ë¶€ ê³ ì • IP ì£¼ì†Œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ê³ ì • IPê°€ ì„¤ì •ë˜ì–´ ìžˆì§€ ì•Šë‹¤ë©´ ì¸ìŠ¤í„´ìŠ¤ ìž¬ë¶€íŒ… ì‹œë‚˜ ê¸°íƒ€ ì˜¤ë¥˜ë¡œ ì¸í•´ ì™¸ë¶€ IPê°€ ë°”ë€Œì–´ ë²„ë¦´ ìˆ˜ ìžˆìœ¼ë¯€ë¡œ, **ë„¤íŠ¸ì›Œí‚¹ ì„¹ì…˜ì˜ VPC ë„¤íŠ¸ì›Œí¬ > IP ì£¼ì†Œ** ë©”ë‰´ë¡œ ì§„ìž…í•˜ì—¬ **ì™¸ë¶€ ê³ ì • IP ì£¼ì†Œ ì˜ˆì•½** ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.

&nbsp;

![ip option](/blog/assets/posts/asset-deploy-on-gcp-screenshot02.png)

&nbsp;

ì„¤ì • í™”ë©´ì—ì„œ ì‚¬ìš©í•  **ì´ë¦„**ì„ ìž…ë ¥í•˜ê³ , **ë²„ì „**ì„ `IPv4`ë¡œ ì„¤ì •í•œ ë‹¤ìŒ **ì˜ˆì•½** ë²„íŠ¼ì„ í´ë¦­í•´ì¤ë‹ˆë‹¤.

> ì°¸ê³  : ê³ ì • IP ì‚¬ìš©ì— ëŒ€í•œ ë¹„ìš©ì´ ë°œìƒí•  ìˆ˜ëŠ” ìžˆìœ¼ë‚˜, ê²°ì œ ë³´ê³ ì„œë¥¼ ë³´ë©´ ë¹„ìš© í• ì¸ì´ ë“¤ì–´ê°€ëŠ” ê±¸ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

ì´ì œ í„°ë¯¸ë„ì—ì„œ VMì— ì ‘ê·¼í•˜ì—¬ git ê³¼ í”„ë¡œì íŠ¸ ì„¤ì •ì„ í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. VMì— ì ‘ê·¼í•˜ëŠ” ë°©ë²•ê³¼ git í”„ë¡œì íŠ¸ ì„¤ì •ì— ëŒ€í•´ì„œëŠ” ì´ì „ì— ìž‘ì„±í•œ ë‚´ìš©ì„ ì°¸ê³ í–ˆìŠµë‹ˆë‹¤.

> ì´ì „ ê¸€ - VM(ê°€ìƒë¨¸ì‹ ) í™˜ê²½ì—ì„œ í”„ë¡œì íŠ¸ ë°°í¬í•˜ê¸° : [ë§í¬](https://ji-hoon.github.io/blog/project-release-on-vm){:target="_blank"}

&nbsp;

## 3. NginXì™€ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •í•˜ê¸°

ì´ì „ ê¸€ì—ì„œ NginXë¥¼ ì„¤ì •í–ˆì„ ë•ŒëŠ” ì•„ëž˜ì²˜ëŸ¼ `proxy_pass` ê°’ì„ ìˆ˜ì •í•˜ëŠ” ìž‘ì—…ë§Œ ì§„í–‰í–ˆì—ˆëŠ”ë° ì´ë²ˆ í”„ë¡œì íŠ¸ì˜ ê²½ìš°ì—ëŠ” í´ë¼ì´ì–¸íŠ¸ì™€ ë°±ì—”ë“œ í”„ë¡œì íŠ¸ê°€ ê°™ì´ ìžˆëŠ” ë ˆí¬ì§€í† ë¦¬ë‹¤ë³´ë‹ˆ, NginX ì„¤ì •ì´ ì¢€ ë” í•„ìš”í–ˆìŠµë‹ˆë‹¤.

```shell
(ê¸°ì¡´) try_files $uri $uri/ =404; 
(ë³€ê²½) proxy_pass http://127.0.0.1:3000; 
```

ë¨¼ì € ```sudo nano /etc/nginx/sites-available/default``` ëª…ë ¹ì–´ë¡œ nginx ì„¤ì • íŒŒì¼ì„ ì—½ë‹ˆë‹¤.

```shell
root /home/{ê³„ì •ì´ë¦„}/home_accountant/Home-accountant/server/dist;

# Add index.php to the list if you are using PHP
index index.html index.htm index.nginx-debian.html;

server_name _;

location / {
    # First attempt to serve request as file, then
    # as directory, then fall back to displaying a 404.
    try_files $uri $uri/ /index.html;
    proxy_pass http://127.0.0.1:5001;

}

location /api {
    proxy_pass http://127.0.0.1:5001;
}
```

1. ë¨¼ì € í´ë¼ì´ì–¸íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•œ íŒŒì¼ì„ serve í•  ì„œë²„ í”„ë¡œì íŠ¸ì˜ ë¹Œë“œ í´ë” ê²½ë¡œë¥¼ root ë””ë ‰í† ë¦¬ë¡œ ìž¡ì•„ì¤ë‹ˆë‹¤. (ì—¬ê¸°ì„œëŠ” dist)
2. location / ê²½ë¡œë¡œ ì ‘ê·¼í–ˆì„ ë•Œ, ëª¨ë“  routeê°€ index.htmlë¡œ ì ‘ê·¼í•  ìˆ˜ ìžˆë„ë¡ try_files ê²½ë¡œë¥¼ ìˆ˜ì •í•´ì¤ë‹ˆë‹¤.
3. proxy_pass ê°’ì€ ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ìˆ˜ì •í•´ì¤ë‹ˆë‹¤. (í¬íŠ¸ë§Œ 5001ë¡œ ë³€ê²½, ì´ í¬íŠ¸ ë²ˆí˜¸ëŠ” ë°©í™”ë²½ ì„¤ì • ì‹œ í•„ìš”í•˜ë‹ˆ ìž˜ ê¸°ì–µí•´ë‘¡ë‹ˆë‹¤.)
4. ë§ˆì§€ë§‰ìœ¼ë¡œ index.htmlì—ì„œ apië¡œì˜ ì ‘ê·¼ì„ í—ˆìš©í•´ì£¼ì–´ì•¼ í•˜ë¯€ë¡œ, /api ê²½ë¡œë„ proxy_pass ê°’ì— ì¶”ê°€í•´ì¤ë‹ˆë‹¤.

ê·¸ ë‹¤ìŒì€ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸ì™€ ë°±ì—”ë“œ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê¸° ì „ì— ì•„ëž˜ì²˜ëŸ¼ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•´ì¤ë‹ˆë‹¤.

> í´ë¼ì´ì–¸íŠ¸ í™˜ê²½ ë³€ìˆ˜

```shell
(ë¡œì»¬)
VITE_BACKEND_URL="http://localhost:5001"
VITE_FRONTEND_URL="http://localhost:5173"

(VM)
VITE_BACKEND_URL="http://35.231.16.39"
VITE_FRONTEND_URL="http://35.231.16.39"
```

ë¡œì»¬ í™˜ê²½ì—ì„œ ê°œë°œí•  ë•ŒëŠ” ê°ê°ì˜ í¬íŠ¸ë¥¼ ë‹¤ë¥´ê²Œ ì„¤ì •í–ˆì§€ë§Œ í´ë¼ì´ì–¸íŠ¸ ë¹Œë“œ í›„ server í”„ë¡œì íŠ¸ì˜ dist í´ë”ë¡œ í•©ì³ì§€ê²Œ ë˜ë¯€ë¡œ, ê° URLì— ë™ì¼í•œ ì£¼ì†Œë¥¼ í• ë‹¹í•©ë‹ˆë‹¤. ì´ ì£¼ì†Œì—ëŠ” 2ë²ˆ í•­ëª©ì—ì„œ ìƒì„±í–ˆë˜ **VM ì¸ìŠ¤í„´ìŠ¤ì˜ ì™¸ë¶€ ê³ ì • IP**ë¥¼ `/` **ì—†ì´** ìž…ë ¥í•´ì¤ë‹ˆë‹¤. ë‹¤ìŒì€ ì„œë²„ í”„ë¡œì íŠ¸ì˜ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.

> ì„œë²„ í™˜ê²½ ë³€ìˆ˜

```shell
(ë¡œì»¬)
PORT=5001
IP=localhost
FRONTEND_URL="http://localhost:5173"
BACKEND_URL="http://localhost:5001"

(VM)
PORT=5001
IP=127.0.0.1
FRONTEND_URL="http://35.231.16.39"
BACKEND_URL="http://35.231.16.39"
```

í¬íŠ¸ì™€ IPëŠ” NginX í™˜ê²½ ì„¤ì • ëŒ€ë¡œ ìž…ë ¥í•´ì£¼ê³ , URLì˜ ê²½ìš° í´ë¼ì´ì–¸íŠ¸ í™˜ê²½ ë³€ìˆ˜ì™€ ë™ì¼í•˜ê²Œ **VM ì¸ìŠ¤í„´ìŠ¤ì˜ ì™¸ë¶€ ê³ ì • IP**ë¥¼ `/` **ì—†ì´** ìž…ë ¥í•´ì¤ë‹ˆë‹¤. (IP ê°’ì— ip í˜•íƒœë¡œ ì§€ì •í•˜ì§€ ì•Šì„ ê²½ìš°, `tcp`ë¡œ ì„¤ì •ë˜ì§€ ì•Šì„ ìˆ˜ ìžˆê¸° ë•Œë¬¸ì— `localhost`ê°€ ì•„ë‹Œ `127.0.0.1`ë¡œ ìž…ë ¥í•´ì¤ë‹ˆë‹¤.) 

&nbsp;

`tcp`ë¡œ ë™ìž‘í•˜ëŠ”ì§€ ì—¬ë¶€ëŠ” í„°ë¯¸ë„ì—ì„œ ```netstat -tuln``` ëª…ë ¹ì–´ë¡œ í™•ì¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```shell
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State    
...  
tcp        0      0 127.0.0.1:5001          0.0.0.0:*               LISTEN     
...
```


&nbsp;

## 4. ë°©í™”ë²½ ì„¤ì •í•˜ê¸°

ì´ì œ ë§ˆì§€ë§‰ìœ¼ë¡œ ë°©í™”ë²½ ì„¤ì •ì„ í•´ì•¼ í•©ë‹ˆë‹¤. **ë„¤íŠ¸ì›Œí‚¹ ì„¹ì…˜ì˜ VPC ë„¤íŠ¸ì›Œí¬ > ë°©í™”ë²½** ë©”ë‰´ë¡œ ì§„ìž…í•˜ì—¬ **ë°©í™”ë²½ ê·œì¹™ ë§Œë“¤ê¸°** ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.

&nbsp;

![firewall](/blog/assets/posts/asset-deploy-on-gcp-screenshot04.png)

&nbsp;

ì´ë¦„ê³¼ ì„¤ëª…ì„ ìž…ë ¥í•´ì¤ë‹ˆë‹¤. íŠ¸ëž˜í”½ ë°©í–¥ì€ `ì¸ê·¸ë ˆìŠ¤(ìˆ˜ì‹ )`ìœ¼ë¡œ, ì†ŒìŠ¤ í•„í„°ëŠ” `ipv4`, ë²”ìœ„ëŠ” `0.0.0.0/0` ìœ¼ë¡œ ìž…ë ¥í•˜ì—¬ ëª¨ë“  ipì—ì„œì˜ ìš”ì²­ì„ í—ˆìš©í•©ë‹ˆë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ í”„ë¡œí† ì½œ ë° í¬íŠ¸ ì˜µì…˜ì€ `TCP - 5001`ë¡œ ìž…ë ¥í•´ì¤€ ë’¤, ë§Œë“¤ê¸° ë²„íŠ¼ìœ¼ë¡œ ê·œì¹™ì„ ìƒì„±í•©ë‹ˆë‹¤. (**ì—¬ê¸°ì„œ ìž…ë ¥í•œ í¬íŠ¸ ë²ˆí˜¸ëŠ” ì„œë²„ í”„ë¡œì íŠ¸ í™˜ê²½ ë³€ìˆ˜ì—ì„œ ì„¤ì •í•œ í¬íŠ¸ ë²ˆí˜¸ì™€ ë™ì¼í•´ì•¼ í•©ë‹ˆë‹¤.**)

&nbsp;

ì´ì œ ì„¤ì •ì´ ëª¨ë‘ ì™„ë£Œ ë˜ì—ˆìŠµë‹ˆë‹¤. í„°ë¯¸ë„ë¡œ ëŒì•„ê°€ì„œ ì„œë²„ë¥¼ ì‹¤í–‰ ì‹œí‚¤ë©´ ì™¸ë¶€ ê³ ì • IPë¥¼ í†µí•´ í”„ë¡œì íŠ¸ì— ì ‘ì†í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

&nbsp;

![firewall](/blog/assets/posts/asset-deploy-on-gcp-screenshot05.png)

&nbsp;


> ì°¸ê³ í•˜ë©´ ì¢‹ì€ ë§í¬ - GCPì— ì›¹ ì„œë²„ ë°°í¬í•˜ê¸° : [ë§í¬](https://uzzam.dev/38?category=1026425)


> íƒœê·¸ Tag : #react #typescript #gcp #vm